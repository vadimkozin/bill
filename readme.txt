# Телефонный биллинг
1) Установить Docker Desktop (https://docs.docker.com/desktop/)
2) Скачать bill.zip
3) Разархивировать bill.zip в удобном месте
 из архива получим: /cfg/cfg.py и run.sh

/cfg/cfg.py - файл с параметрами (подключение к БД, пути и пр.)
run.sh - bash-скрипт для запуска

Сам биллинг разбит на 5 действий: load, bill, mts, mest, local; Еще есть 'info' для статистики
Действия можно запускать по одному в последовательности: load, bill, mts, mest, local
Или выполнить одно действие all

Примеры запуска всех 5 действий для расчёта за апрель-2022 (расчёт ведётся в мае)
./run.sh 2022 4 info    // статистика данных SMG-станции по дням за апрель 2022
./run.sh 2022 4 load    // загрузка данных SMG-станции в биллинг (bill.Y2022M04)
./run.sh 2022 4 bill    // расчёт по загруженным данным
./run.sh 2022 4 mts     // формирование отчётов для выгрузки на портал МТС
./run.sh 2022 4 mest    // расчёт местной связи (есть несколько новых клиентов)
./run.sh 2022 4 local   // расчёт повремёнки (местная >450 мин) (почти нет)

или
./run.sh 2022 4 all     // выполнит все 5 действий: load, bill, mts, mest, local

в результате:
 a) created directory: ./result и ./log
 b) ./result/2022_04:
    ./result/2022_04/book   - книга счетов и Акт (акт нужен для выгрузки на портал МТС)
    ./result/2022_04/mts    - csv-файлы (поддиректория cp1251 для выгрузки на портал МТС)
    ./result/2022_04/mest   - местная связь (немного)
    ./result/2022_04/loc    - повремёнка (иногда)

далее выгрузка данных на портал МТС:
 1. Выгружаем 3 файла из на портал МТС и заполняем одну форму:
 (портал МТС: agnt.mts.ru)
 Объём оказанных услуг по направлениям: ./result/2022_04/mts/cp1251/2022_04_ALL_объём_оказ_услуг.csv
 Итоги периода: заполнить форму из ./result/2022_04/book/2022_04_book.xls - вкладка Акт
 Книга продаж: ./result/2022_04/mts/cp1251/2022_04_ALL_книга_продаж.csv
 Детализация уступки требований:  ./result/2022_04/mts/cp1251/2022_04_ALL_детал_уступки_треб.csv

 2. Нажимаем кнопку "Проверка данных".

@Разное.
PS. Для рассчёта за май-2022 запускать run.sh можно будет начиная с 1-го июня, с 8 утра, так как примерно в 7 утра
дозагружаются данные за последний день

PS. Перед расчётом нужно обязательно посмотреть данные SMG. (action=info) Может быть данных мало.
Достаточно посмотреть распределение минут по дням месяца. В рабочие дни минут больше, в выходные меньше:
./run.sh 2022 4 info  - напечатает статистику по дням месяца (день - связей - минут)
